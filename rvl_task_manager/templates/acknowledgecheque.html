<!DOCTYPE html>
<html>
<head>

<link type="text/css" href="/static/css/bootstrap.css" rel="stylesheet"  />
<link type="text/css" href="/static/css/jquery.selectBoxIt.css" rel="stylesheet" />
<link type="text/css" href="/static/css/task.css" rel="stylesheet" />
<!-- Madura css -->
<link rel="stylesheet" href="/static/css/font-icons/entypo/css/entypo.css"  id="style-resource-2">
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic"  id="style-resource-3">
<link rel="stylesheet" href="/static/css/neon-core-min.css"  id="style-resource-5">
<link rel="stylesheet" href="/static/css/neon-theme-min.css"  id="style-resource-6">
<link rel="stylesheet" href="/static/css/neon-form-min.css"  id="style-resource-7">
<link rel="stylesheet" href="/static/css/jalert.css">
<link rel="stylesheet" href="/static/css/form.css">
<link rel="stylesheet" href="/static/css/custom2.css"><!-- custom css for loan officer process -->

<!-- Scripts -->
<script type="text/javascript" src="/static/js/1.9.1-jquery.min.js"></script><!-- Main Library js-->
<script type="text/javascript" src="/static/js/jquery-ui.min.js"></script><!-- Main Library js-->
<script type="text/javascript" src="/static/js/bootstrap.js"></script><!-- Bootstrap js-->
<script type="text/javascript" src="/static/js/jquery.selectBoxIt.js"></script>
<script type="text/javascript" src="/static/js/crossfilter.js"></script> 

<!--MASTER DATA -->
<script type="text/javascript" src="/static/form/masterData.js"></script> 
<script type="text/javascript" src="/static/form/masterDataLoad.js"></script> 

</head>
<body>
	<!-- Top Bar -->
	<div class="navbar navbar-fixed-top">
		{% include "header_common.html" %} 
	</div>

	{% csrf_token %}
	<!-- Main Content -->
    	<div class="main">	
	     <div class="task-div">	
		 <div class="main-task">
		      <div  class="right-pane-task" id="right-pane-task" style="width:100%;margin: 10 auto;">
			  <div class="center-pane" style="width:50%;margin: 3% auto; display:block;"> 
				<div class="h3-heading">
					<h3 >Acknowledge Loan Cheque</h3>
					<h4 id="cheque_id"></h4>
				</div>

				<div class="member_class" >
				    <div class="colomn-div"><label>Courier Name  </label><font> : </font><label id="chq_courier_name"	name=""     placeholder="COURIER NUMBER"  style="text-align: left;"	></label></div>
				</div>
				<div class="member_class" >
				    <div class="colomn-div"><label>Receipt Number</label><font> : </font><label id="chq_courier_receipt_number"  name=""  placeholder="RECEIPT NUMBER"	style="text-align:left;"></label></div>
				</div>
				<div class="member_class">
				    <div class="colomn-div"><label>Tracking Id   </label><font> : </font><label id="chq_courier_tracking_id"     name=""  placeholder="TRACKING ID"	style="text-align:left;"></label></div>
				</div>
				<div class="member_class">
				    <div  class="colomn-div"><label>Date         </label><font> : </font><label id="chq_courier_handover_date"   name=""  placeholder="DATE"	style="text-align: left;"></label></div>
				</div>
				<!-- Acknowledge Button div -->
				<div class="form-group text-center">
				    <div class="form-button">
					<a href="javascript:void(0)" onclick='window.location="/tasks/"' class="btn btn-red btn-icon icon-left" style="height:30px;padding-left:40px;">
					   <i class="icon-entypo-cancel" style="width:30px;height: 28px;color: white;padding:6px;"></i>
					    Cancel
					</a>
					<a href="javascript:void(0)" onclick="onSubmit();" class="btn btn-red btn-icon icon-left" style="height:30px;padding-left:40px;">
					    <i class="icon-entypo-check" style="width:30px;height: 28px;color: white;padding:6px;"></i>
					    Acknowledge
					</a>
				    </div>
				</div>
			   </div> 
		       </div>
		  </div>
	     </div>
  	</div>

	{% include "footer.html" %} 
</body>
<script type="text/javascript">  
	
var taskData = {};

var memberdetails = '{{memberDetails|safe}}';
var processid 	= '{{processId|safe}}';
var process 	= '{{process|safe}}';
var taskid 	= '{{taskId|safe}}';
var User 	= '{{user|safe}}';
var userid	= '{{userId|safe}}';
var memberId 	= '{{memberId|safe}}';
var loanId 	= '{{loanId|safe}}';
var remarks 	= '{{Application_Remarks|safe}}';
var processObj 	= JSON.parse(process);
var chq_id 	= '';

jQuery(document).ready(function($) {
    $('.dropDownHook span').on('click', function() {
        $(this).parents('.dropDownHook').children('.dropDownContent').stop(true, true).slideToggle('medium', function() {
            if ($('.dropDownContent').is(':visible')) {
                //  This alters the content of the "hook" when we open the drop down
            }
            else {
                //  This alters the content of the "hook" when we close the dropdown
            }
        });
    });
    $('html').on('click', function() {
        $('.dropDownContent:visible').slideToggle('fast');
    });

    $('.dropDownHook > *').on('click', function(event) {
        event.stopPropagation();
    });
    if(processObj['ChequeId']){	
	if(processObj['ChequeId']['value']){
	    chq_id = processObj['ChequeId']['value'];
	   		
	    if(loanId){
		document.getElementById("cheque_id").innerHTML = "Cheque No :  " +chq_id+ "    &   Member Id : "+memberId+"  &  Loan Id  : "+loanId;
	    }
	}
   }
   
   /*Master Data Parsing and Paint data in HTML*/
   setSelectOptionInForm();	/*Function in masterDataLoad.js	*/
   
   /*Data parsing and painting data in HTML*/
   if(memberdetails){
	memberdetails =  JSON.parse(memberdetails);
	if(memberdetails['dcphysicalArray']){
	    if(memberdetails['dcphysicalArray'][0]){
		var dcphysicalArray = memberdetails['dcphysicalArray'][0];
		var keys = Object.keys(dcphysicalArray);
		for(var i=0; i<keys.length; i++){
		    if($.inArray(keys[i], selectionFields) != -1){
			/*Select Option data*/
			if(selectionFieldMasters[keys[i]]){
			    if(selectionFieldMasters[keys[i]][dcphysicalArray[keys[i]]]){						
			    	/*Select Option data to paint on LABEL*/
			    	if(document.getElementById(keys[i])){
				    document.getElementById(keys[i]).innerHTML = selectionFieldMasters[keys[i]][dcphysicalArray[keys[i]]];
				}
			    }else{
				if(document.getElementById(keys[i])){
				    /*INPUT TYPE TEXT DATA*/
				    document.getElementById(keys[i]).innerHTML = dcphysicalArray[keys[i]];
				}
			    }
			}else{
				/*INPUT TYPE TEXT DATA*/
				document.getElementById(keys[i]).innerHTML = dcphysicalArray[keys[i]];
			}
		    }else{	
			/*INPUT TYPE TEXT DATA*/
			if(document.getElementById(keys[i])){
			    document.getElementById(keys[i]).innerHTML = dcphysicalArray[keys[i]];
			}
		    }
		}
	    }
	}
    }
});

function onSubmit(){

	/*Process Data*/
	var processCompleteTask = {
				"variables": {
				    "LoanCheque_Aknow_Status" : {
					"value" : "Received", 
					"type"	: "String"
				    }
				}
			    };

	/*Merge Process Data and Taskid to UPdate TASK*/
	var dataObj = {
		"processDetails" : processCompleteTask,
		"taskid"	 : taskid
	}

	/*AJAX call : to acknowledge but this will only Update PROCESS*/
	var url = "/acknowledgeCheque/";
	$.ajax({
	    url: url,
	    type: 'post',
	    dataType: 'json',
	    success: function (data) {
		window.location='/tasks/';	
	    },
	    data: JSON.stringify(dataObj)
	});
}
</script>
</html> 
